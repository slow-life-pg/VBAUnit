from xlwings import Sheet
from vbaunit_lib.testlib import gettestlib, expect  # noqa


def test_clearsolution():
    testlib = gettestlib()
    with testlib.runapp("..\\product\\NumberPlaceSolver.xlsm") as book:
        solutionsheet: Sheet = book.sheets["solution"]
        solution = [
            [1, 2, 3, 4, 5, 6, 7, 8, 9],
            [4, 5, 6, 7, 8, 9, 1, 2, 3],
            [7, 8, 9, 1, 2, 3, 4, 5, 6],
            [2, 3, 4, 5, 6, 7, 8, 9, 1],
            [5, 6, 7, 8, 9, 1, 2, 3, 4],
            [8, 9, 1, 2, 3, 4, 5, 6, 7],
            [3, 4, 5, 6, 7, 8, 9, 1, 2],
            [6, 7, 8, 9, 1, 2, 3, 4, 5],
            [9, 1, 2, 3, 4, 5, 6, 7, 8],
        ]
        solutionsheet["A1"].value = solution

        testlib.callmacro(None, "ClearSolutionSheet")
        expectation = [
            [None, None, None, None, None, None, None, None, None],
            [None, None, None, None, None, None, None, None, None],
            [None, None, None, None, None, None, None, None, None],
            [None, None, None, None, None, None, None, None, None],
            [None, None, None, None, None, None, None, None, None],
            [None, None, None, None, None, None, None, None, None],
            [None, None, None, None, None, None, None, None, None],
            [None, None, None, None, None, None, None, None, None],
            [None, None, None, None, None, None, None, None, None],
        ]
        expect(solutionsheet["A1:I9"].value == expectation)
        expect(solutionsheet["K1:K1"].value is None)
