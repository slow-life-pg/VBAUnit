# マクロを追加して実行するための実験
:icons: font

## Excelの設定
### トラストセンター
|===
|信頼できる場所| 追加 > A:\Dev\VBAUnit
|ActiveXの設定|2番目 = ～初期化に危険が伴う～
|マクロの設定|警告してVBAマクロを無効にする +
VBA プロジェクト オブジェクト モデルへのアクセスを信頼する
|メッセージバー|ActiveXコントロールやマクロなどの～
|ファイル制限機能の設定|Excelアドイン > 保護ビューで開き編集可能にする
|===
結局、信頼できる場所はたぶんそんなに影響がなく、
「VBA プロジェクト オブジェクト モデルへのアクセスを信頼する」さえしておけば良さそう。

## マクロ追加方法
### Import
モジュールのファイルがある場合は``Import``できる。
拡張子は何でもイイっぽい。

### AddFromString
その場で生成した文字列を新規モジュールとして追加できる。

## Classインスタンス
Classモジュールの宣言で``Instancing``属性を``2 - PublicNotCreatable``にする。
これをしないとPython側に外部公開できないらしい。

``1 - Private``がネットでは推奨されているがPythonのためには必要。

これを強引にやるなら、ソースを一旦テキスト化して、属性を書き換えてインポートし直すこと。
既存の色々なものが壊れそうで怖い。
